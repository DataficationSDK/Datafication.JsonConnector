# JsonExport Sample

Demonstrates how to convert DataBlocks back to JSON format using the JsonStringSink extension methods.

## Overview

This sample shows how to:
- Export DataBlocks to JSON strings using `JsonStringSinkAsync()`
- Export using the synchronous `JsonStringSink()` method
- Handle single records (JSON object) vs multiple records (JSON array)
- Transform data before exporting
- Perform roundtrip operations (load -> modify -> export)

## Key Features Demonstrated

### Asynchronous Export (Recommended)

```csharp
var jsonOutput = await dataBlock.JsonStringSinkAsync();
await File.WriteAllTextAsync("output.json", jsonOutput);
```

### Synchronous Export

```csharp
var jsonOutput = dataBlock.JsonStringSink();
File.WriteAllText("output.json", jsonOutput);
```

### Single Record vs Array Output

```csharp
// Multiple records produce a JSON array
var multipleRecords = data.Head(5);
var arrayJson = multipleRecords.JsonStringSink();  // Returns: [{"...": "..."}, ...]

// Single record produces a JSON object
var singleRecord = data.Head(1);
var objectJson = singleRecord.JsonStringSink();  // Returns: {"...": "..."}
```

### Transform Then Export

```csharp
var filtered = data
    .Where("Department", "Engineering")
    .Sort(SortDirection.Descending, "Salary")
    .Select("Name", "Salary");

var json = await filtered.JsonStringSinkAsync();
```

## How to Run

```bash
cd JsonExport
dotnet restore
dotnet run
```

## Expected Output

```
=== Datafication.JsonConnector Export Sample ===

1. Loading source JSON data...
   Loaded 50 employees

2. Exporting full dataset to JSON (async)...
   Generated JSON with 8,XXX characters
   Preview (first 200 chars): [{"Id":1,"Name":"Alice Johnson"...

3. Exporting single record...
   Single record JSON:
   {"Id":1,"Name":"Alice Johnson","Department":"Engineering",...}

4. Transform then export: Engineering department only...
   Exported 18 engineers
   JSON length: 3,XXX characters

5. Export with column selection...
   Summary JSON (5 employees, 3 columns):
   [{"Name":"...","Department":"...","Salary":...}, ...]

6. Roundtrip: Load -> Filter -> Sort -> Export...
   Top 3 earners:
   [{"Name":"...","Department":"Engineering","Salary":102000}, ...]

7. Saving exported JSON to file...
   Saved to: .../data/output_employees.json

=== Sample Complete ===
```

## Data Files

- **Input**: `data/employees.json` - 50 employee records
- **Output**: `data/output_employees.json` - Generated by the sample

## Related Samples

- **JsonBasicLoad** - Loading JSON files into DataBlocks
- **JsonETLPipeline** - Complete ETL workflows with JSON
- **JsonConfiguration** - Advanced configuration options
